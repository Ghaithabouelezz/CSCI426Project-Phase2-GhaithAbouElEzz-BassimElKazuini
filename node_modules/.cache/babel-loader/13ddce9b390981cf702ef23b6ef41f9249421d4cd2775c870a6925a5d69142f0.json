{"ast":null,"code":"// In Library.js, update the useEffect for cart count:\nuseEffect(() => {\n  const fetchCartCount = async () => {\n    try {\n      const response = await getCartItemCount();\n      setCartCount(response.totalItems || response.count || 0);\n    } catch (error) {\n      console.error('Error fetching cart count:', error);\n      setCartCount(0);\n    }\n  };\n  fetchCartCount();\n}, []);\n\n// Update addToCart function\nconst addToCart = async book => {\n  try {\n    if (!book.id) {\n      alert('❌ Book ID is missing');\n      return;\n    }\n\n    // Check if user is logged in\n    const user = JSON.parse(localStorage.getItem('user'));\n    if (!user) {\n      alert('❌ Please login to add items to cart');\n      window.location.href = '/';\n      return;\n    }\n    if (book.quantity <= 0) {\n      alert('❌ This book is out of stock');\n      return;\n    }\n    const response = await addToCartAPI(book.id);\n    if (response.data.success) {\n      const cartResponse = await getCartItemCount();\n      setCartCount(cartResponse.totalItems || cartResponse.count || 0);\n      alert(`✅ Added \"${book.title}\" to cart!`);\n    } else {\n      alert(`❌ ${response.data.error || 'Failed to add to cart'}`);\n    }\n  } catch (error) {\n    console.error('Error adding to cart:', error);\n    if (error.message === 'User not logged in') {\n      alert('❌ Please login to add items to cart');\n      window.location.href = '/';\n    } else {\n      var _error$response, _error$response$data;\n      alert(`❌ ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Error adding to cart'}`);\n    }\n  }\n};","map":{"version":3,"names":["useEffect","fetchCartCount","response","getCartItemCount","setCartCount","totalItems","count","error","console","addToCart","book","id","alert","user","JSON","parse","localStorage","getItem","window","location","href","quantity","addToCartAPI","data","success","cartResponse","title","message","_error$response","_error$response$data"],"sources":["C:/Users/leokr/project/src/Pages/Library.js"],"sourcesContent":["// In Library.js, update the useEffect for cart count:\r\nuseEffect(() => {\r\n  const fetchCartCount = async () => {\r\n    try {\r\n      const response = await getCartItemCount();\r\n      setCartCount(response.totalItems || response.count || 0);\r\n    } catch (error) {\r\n      console.error('Error fetching cart count:', error);\r\n      setCartCount(0);\r\n    }\r\n  };\r\n\r\n  fetchCartCount();\r\n}, []);\r\n\r\n// Update addToCart function\r\nconst addToCart = async (book) => {\r\n  try {\r\n    if (!book.id) {\r\n      alert('❌ Book ID is missing');\r\n      return;\r\n    }\r\n    \r\n    // Check if user is logged in\r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n    if (!user) {\r\n      alert('❌ Please login to add items to cart');\r\n      window.location.href = '/';\r\n      return;\r\n    }\r\n    \r\n    if (book.quantity <= 0) {\r\n      alert('❌ This book is out of stock');\r\n      return;\r\n    }\r\n    \r\n    const response = await addToCartAPI(book.id);\r\n    \r\n    if (response.data.success) {\r\n      const cartResponse = await getCartItemCount();\r\n      setCartCount(cartResponse.totalItems || cartResponse.count || 0);\r\n      alert(`✅ Added \"${book.title}\" to cart!`);\r\n    } else {\r\n      alert(`❌ ${response.data.error || 'Failed to add to cart'}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error adding to cart:', error);\r\n    if (error.message === 'User not logged in') {\r\n      alert('❌ Please login to add items to cart');\r\n      window.location.href = '/';\r\n    } else {\r\n      alert(`❌ ${error.response?.data?.error || 'Error adding to cart'}`);\r\n    }\r\n  }\r\n};"],"mappings":"AAAA;AACAA,SAAS,CAAC,MAAM;EACd,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMC,gBAAgB,CAAC,CAAC;MACzCC,YAAY,CAACF,QAAQ,CAACG,UAAU,IAAIH,QAAQ,CAACI,KAAK,IAAI,CAAC,CAAC;IAC1D,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClDH,YAAY,CAAC,CAAC,CAAC;IACjB;EACF,CAAC;EAEDH,cAAc,CAAC,CAAC;AAClB,CAAC,EAAE,EAAE,CAAC;;AAEN;AACA,MAAMQ,SAAS,GAAG,MAAOC,IAAI,IAAK;EAChC,IAAI;IACF,IAAI,CAACA,IAAI,CAACC,EAAE,EAAE;MACZC,KAAK,CAAC,sBAAsB,CAAC;MAC7B;IACF;;IAEA;IACA,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;IACrD,IAAI,CAACJ,IAAI,EAAE;MACTD,KAAK,CAAC,qCAAqC,CAAC;MAC5CM,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,GAAG;MAC1B;IACF;IAEA,IAAIV,IAAI,CAACW,QAAQ,IAAI,CAAC,EAAE;MACtBT,KAAK,CAAC,6BAA6B,CAAC;MACpC;IACF;IAEA,MAAMV,QAAQ,GAAG,MAAMoB,YAAY,CAACZ,IAAI,CAACC,EAAE,CAAC;IAE5C,IAAIT,QAAQ,CAACqB,IAAI,CAACC,OAAO,EAAE;MACzB,MAAMC,YAAY,GAAG,MAAMtB,gBAAgB,CAAC,CAAC;MAC7CC,YAAY,CAACqB,YAAY,CAACpB,UAAU,IAAIoB,YAAY,CAACnB,KAAK,IAAI,CAAC,CAAC;MAChEM,KAAK,CAAC,YAAYF,IAAI,CAACgB,KAAK,YAAY,CAAC;IAC3C,CAAC,MAAM;MACLd,KAAK,CAAC,KAAKV,QAAQ,CAACqB,IAAI,CAAChB,KAAK,IAAI,uBAAuB,EAAE,CAAC;IAC9D;EACF,CAAC,CAAC,OAAOA,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC7C,IAAIA,KAAK,CAACoB,OAAO,KAAK,oBAAoB,EAAE;MAC1Cf,KAAK,CAAC,qCAAqC,CAAC;MAC5CM,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,GAAG;IAC5B,CAAC,MAAM;MAAA,IAAAQ,eAAA,EAAAC,oBAAA;MACLjB,KAAK,CAAC,KAAK,EAAAgB,eAAA,GAAArB,KAAK,CAACL,QAAQ,cAAA0B,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBL,IAAI,cAAAM,oBAAA,uBAApBA,oBAAA,CAAsBtB,KAAK,KAAI,sBAAsB,EAAE,CAAC;IACrE;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}