{"ast":null,"code":"import axios from 'axios';\nconst API = axios.create({\n  baseURL: 'http://localhost:5000/api',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 10000\n});\n\n// Get current user ID from localStorage\nconst getCurrentUserId = () => {\n  const user = JSON.parse(localStorage.getItem('user'));\n  return user ? user.id : null;\n};\n\n// ========== BOOK APIs ==========\nexport const getBooks = () => API.get('/books');\nexport const searchBooks = term => API.get(`/books/search?term=${encodeURIComponent(term)}`);\nexport const filterBooksByGenre = genre => API.get(`/books/filter/${encodeURIComponent(genre)}`);\n\n// ========== CART APIs ==========\nexport const addToCart = bookId => {\n  const userId = getCurrentUserId();\n  if (!userId) {\n    return Promise.reject(new Error('User not logged in'));\n  }\n  console.log('Adding to cart for user:', userId, 'book:', bookId);\n  return API.post('/cart/add', {\n    userId,\n    bookId\n  });\n};\nexport const getCartItems = () => {\n  const userId = getCurrentUserId();\n  if (!userId) {\n    return Promise.resolve({\n      data: []\n    });\n  }\n  return API.get(`/cart?userId=${userId}`);\n};\nexport const removeFromCart = cartItemId => {\n  const userId = getCurrentUserId();\n  if (!userId) {\n    return Promise.reject(new Error('User not logged in'));\n  }\n  console.log('Removing cart item:', cartItemId, 'for user:', userId);\n  return API.delete(`/cart/${cartItemId}`, {\n    data: {\n      userId\n    }\n  });\n};\nexport const clearCart = () => {\n  const userId = getCurrentUserId();\n  if (!userId) {\n    return Promise.reject(new Error('User not logged in'));\n  }\n  return API.delete(`/cart/clear`, {\n    data: {\n      userId\n    }\n  });\n};\nexport const getCartItemCount = async () => {\n  try {\n    const userId = getCurrentUserId();\n    if (!userId) return {\n      count: 0,\n      totalItems: 0\n    };\n    const response = await API.get(`/cart/count?userId=${userId}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error getting cart count:', error);\n    return {\n      count: 0,\n      totalItems: 0\n    };\n  }\n};\n\n// ========== USER APIs ==========\nexport const loginUser = (username, password) => {\n  return API.post('/login', {\n    username,\n    password\n  });\n};\nexport const registerUser = (username, password) => {\n  return API.post('/register', {\n    username,\n    password\n  });\n};\n\n// Logout function\nexport const logoutUser = () => {\n  localStorage.removeItem('user');\n  return Promise.resolve();\n};\n\n// Add error interceptor\nAPI.interceptors.response.use(response => {\n  console.log('✅ API Response:', response.config.url, response.status);\n  return response;\n}, error => {\n  var _error$config, _error$response;\n  console.error('❌ API Error:', (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url, (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status, error.message);\n  return Promise.reject(error);\n});\nexport default API;","map":{"version":3,"names":["axios","API","create","baseURL","headers","timeout","getCurrentUserId","user","JSON","parse","localStorage","getItem","id","getBooks","get","searchBooks","term","encodeURIComponent","filterBooksByGenre","genre","addToCart","bookId","userId","Promise","reject","Error","console","log","post","getCartItems","resolve","data","removeFromCart","cartItemId","delete","clearCart","getCartItemCount","count","totalItems","response","error","loginUser","username","password","registerUser","logoutUser","removeItem","interceptors","use","config","url","status","_error$config","_error$response","message"],"sources":["C:/Users/leokr/project/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API = axios.create({\r\n  baseURL: 'http://localhost:5000/api',\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 10000,\r\n});\r\n\r\n// Get current user ID from localStorage\r\nconst getCurrentUserId = () => {\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n  return user ? user.id : null;\r\n};\r\n\r\n// ========== BOOK APIs ==========\r\nexport const getBooks = () => API.get('/books');\r\nexport const searchBooks = (term) => API.get(`/books/search?term=${encodeURIComponent(term)}`);\r\nexport const filterBooksByGenre = (genre) => API.get(`/books/filter/${encodeURIComponent(genre)}`);\r\n\r\n// ========== CART APIs ==========\r\nexport const addToCart = (bookId) => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) {\r\n    return Promise.reject(new Error('User not logged in'));\r\n  }\r\n  console.log('Adding to cart for user:', userId, 'book:', bookId);\r\n  return API.post('/cart/add', { userId, bookId });\r\n};\r\n\r\nexport const getCartItems = () => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) {\r\n    return Promise.resolve({ data: [] });\r\n  }\r\n  return API.get(`/cart?userId=${userId}`);\r\n};\r\n\r\nexport const removeFromCart = (cartItemId) => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) {\r\n    return Promise.reject(new Error('User not logged in'));\r\n  }\r\n  console.log('Removing cart item:', cartItemId, 'for user:', userId);\r\n  return API.delete(`/cart/${cartItemId}`, { data: { userId } });\r\n};\r\n\r\nexport const clearCart = () => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) {\r\n    return Promise.reject(new Error('User not logged in'));\r\n  }\r\n  return API.delete(`/cart/clear`, { data: { userId } });\r\n};\r\n\r\nexport const getCartItemCount = async () => {\r\n  try {\r\n    const userId = getCurrentUserId();\r\n    if (!userId) return { count: 0, totalItems: 0 };\r\n    const response = await API.get(`/cart/count?userId=${userId}`);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error getting cart count:', error);\r\n    return { count: 0, totalItems: 0 };\r\n  }\r\n};\r\n\r\n// ========== USER APIs ==========\r\nexport const loginUser = (username, password) => {\r\n  return API.post('/login', { username, password });\r\n};\r\n\r\nexport const registerUser = (username, password) => {\r\n  return API.post('/register', { username, password });\r\n};\r\n\r\n// Logout function\r\nexport const logoutUser = () => {\r\n  localStorage.removeItem('user');\r\n  return Promise.resolve();\r\n};\r\n\r\n// Add error interceptor\r\nAPI.interceptors.response.use(\r\n  (response) => {\r\n    console.log('✅ API Response:', response.config.url, response.status);\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('❌ API Error:', error.config?.url, error.response?.status, error.message);\r\n    return Promise.reject(error);\r\n  }\r\n  \r\n);\r\n\r\nexport default API;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}